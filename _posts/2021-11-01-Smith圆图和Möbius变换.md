---
layout: post
title:  "Smith圆图和Möbius变换"
---

大学时学微波原理，老师讲Smith圆图，说了很多性质和应用，考试以后就全忘光了。后来工作中用到，每次复习一下，过一阵就又忘掉了。圆图的目的到底是什么？为啥有这么多的圆？这图到底是怎么想出来的？


后来在网上看到一篇叫“史上最经典的史密斯（smith）圆图讲解”的文章[1]，虽然有些民科，却非常形象，很适合我的水平。文章称圆图的目的“就是类似于数学用表一样，通过查找，知道反射系数的数值。……我们现在也不知道，史密斯先生是怎么想到‘史密斯圆图’表示方法的灵感，是怎么来的。很多同学看史密斯原图，死记硬背，不得要领，其实没有揣摩，史密斯老先生的创作意图。我个人揣测：是不是受到黎曼几何的启发，把一个平面的坐标系，给“掰弯”了。“


文章还给出了几张“掰弯”的过程图：

 
![](/images/2021-11-01-Smith圆图和Möbius变换/1a.jpg)
![](/images/2021-11-01-Smith圆图和Möbius变换/1b.jpg)
![](/images/2021-11-01-Smith圆图和Möbius变换/1c.jpg)
图一 掰弯”的过程 [1]


所以Smith圆图就是一个从zL（归一化的负载阻抗）到Γ（反射系数）函数图像，我们可以按图索骥，由zL查出Γ；也可以反过来，从Γ查出zL。只不过这个函数是复数到复数的映射：


Γ(z_L)=(z_L-1)/(z_L+1)


在z_L域的纵横网格线，被函数“掰弯”成Γ域的两组纵横圆圈。这两组圆圈相当于两组地图里的等高线，分别对应x和y的值，大概这就是复变函数图像。


但“最经典“文中并没由解释为什么”掰弯“后的直线是一组圆，也没有讲讲”黎曼几何“是怎么启发史密斯老先生的。我想启发史密斯老先生更可能是复变函数里的Möbius变换（也叫双线性变换）[2]：


f(z)=(az+b)/(cz+d)


可以看到Γ(z_L)就是一个Möbius变换的特例（a=c=1, b=-1, d=1）。Möbius变换的性质之一是“保圆”，也就是把圆映射成圆。直线作为直径无穷大的圆，也被映射成圆。这就解释了为什么纵横交错的直角坐标线在Smith圆图里被映射成圆。Möbius变换可以被分解成平移，拉伸和反演(inversion)变换：


Γ(z)=  (z-1)/(z+1)=1-2/(z+1)


变换的核心是反演，也就是w = 1/z，正是这一步把直线变换成了圆。


![](/images/2021-11-01-Smith圆图和Möbius变换/2.png)

 
图二 Möbius变换把直线变为圆


反演和Möbius变换的另一个性质是“保角”，因此ZL域正交的网格线被隐身成正交的两组圆。Möbius变换把路径的右手侧部分变换成右手侧部分，所以整个ZL右半平面（passive load）被映射到了单位圆的内部。


Möbius变换可以分成几种类型，Γ(z) 有两个不动点，i 和 -i , 因为 (i-1)/(i+1)=i,(-i-1)/(-i+1)=-i。不动点对应的m为-i 和 i。所以Γ(z)是Elliptic型变换。从Elliptic型变换的图中可以想象纵横网格线被掰弯的过程：


![](/images/2021-11-01-Smith圆图和Möbius变换/3.jpg)
 

图三: Elliptic型Möbius变换图 [3]


因为ZL和Γ通过Möbius 变换一一对应，ZL对频率或电感电容值的函数可以直接画在Smith圆图上。这样做的好处是我们可以同时读出ZL和Γ。


[1] http://news.eeworld.com.cn/mp/EEWorld/a92541.jspx


[2] 复分析-可视化方法, T. Needham。


[3] https://en.wikipedia.org/wiki/M%C3%B6bius_transformation 












